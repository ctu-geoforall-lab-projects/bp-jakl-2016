\chapter{Teorie}
\label{2-Teorie}

\section{OpenStreetMap}
\label{OpenStreetMap}

\subsection{Vznik}
\label{vznik}
OpenStreetMap (OSM) je projekt, jež vznikl s cílem vytvoření a sběru 
volně dostupných geografických dat a následně jejich možné vizualizace
do topografických map. Projekt založil Steve Coast v červenci roku 
2004 v Anglii. Jako inspirace mu posloužil projekt Wikipedia.

Zprvu projekt využívalo jen pár nadšenců, postupem času ale získal
projekt popularitu. S nárůstem počtu uživatelů se zvyšoval i objem dat.
Bylo tedy nutné navýšit kapacitu a zabezpečení serverů.
Také bylo potřeba zlepšit síťové řešení a infrastrukturu.
Tím je myšleno, že data byla rozdělena na více serverů.
 
%%% ML: nejen kapacitu serveru, ale cele infrastruktury, resit dalsi otazky (bezpecnost a pod)...

V dubnu roku 2006 byla založena nadace OpenStreetMap Foundantion pro financováni 
projektu jako takového (zaměstnanců, běhu a zajištění bezpečnosti serverů atd.). \cite{wikiOSM}


\subsection{Struktura dat}
\label{struktura dat}
OSM data jsou nyní uložena v databázi PostgreSQL. \cite{OSMserver}

%%% primo v DB, cemuz tak ale neni; XML, resp. OSM je vymenny format
Pro samotnou výměnu dat ale slouží souborový formát {.osm}, který využívá datový
formát  XML. 
Jeho výhoda je jasná struktura, snadná orientace v kódu pro člověka. 
Nevýhodou je ovšem větší objem dat, který lze ale snížit kompresí. 

%%% ML: tady by se hodil vycet (itemize), chtelo by do vysvetlit, co je cesta a pod...
Elementy jsou v OSM rozděleny na:
\begin{itemize}
    \item uzel (node) 

Základním bodovým elementem je uzel (node), který je definován jedinečným
identifikátorem ({\tt id=}). Všechny souřadnice jsou ve WGS~84 (EPGS 4326). 
Je také ukládána verze ({\tt version= }), to jest, kdy byl do databáze přidán
a také zde je uvedeno v jaké změně to bylo provedeno ({\tt changeset=~}).
Dále je možné připojit různé atributy (tag) s klíčem a hodnotou ({\tt tag~k=~v=~}).
\\*
Příklad XML souboru pro uzel (stromu):

{\scriptsize \begin{lstlisting}
<node id="2905214905" visible="true" version="1" changeset="22804106" 
      timestamp="2014-06-08T06:57:20Z" user="Salamandr" 
      uid="1708065" lat="50.1036981" lon="14.3897278">
    <tag k="natural" v="tree"/>
    <tag k="source" v="bing:ortofoto"/>
</node>
\end{lstlisting} }
    \item cesta (way)

Další liniový element je cesta (way) a je vždy určena dva a více uzlů.
Ta má také svůj jedinečný identifikátor ({\tt way~id=~}) v rámci všech cest.
Má vždy základní atributy ({\tt id=*, visible=*, version=*, .. }), 
stejně jako u elementu uzel.
Dále však musí být seznam bodů, ze kterých se skládá.
Je zde uvedena pouze reference na id bodů, nikoliv jejich souřadnice.
Cestám lze taktéž přiřadit různé atributy.

Cesty se dále rozdělují na neuzavřené a uzavřené.
Jen uzavřeným cestám se dají přiřadit atributy určené pro plochy (area).
Například les ({\tt landuse=forest}).

Příklad XML souboru pro cestu:

{\scriptsize
\begin{lstlisting}
<way id="87249754" visible="true" version="2" changeset="34489106"
     timestamp="2015-10-07T11:52:41Z" user="Petr Dlouhý" uid="17615">
    <nd ref="1014526199"/>
    <nd ref="1014525941"/>
    <nd ref="1014526337"/>
    <nd ref="1014526022"/>
    <nd ref="1014526277"/>
    <nd ref="1014525984"/>
    <tag k="highway" v="path"/>
    <tag k="source" v="bing:ortofoto"/>
</way>
\end{lstlisting}
}
      
    \item relace (relation)

Speciálním elementem je relace (relation), do které lze zahrnout
jeden a více elementů. Mohou se do nich spojit elementy stejného (uzel a uzel),
nebo různého druhu (uzely, cesty nebo i relace). 
Například dálnice je tvořena několika cestami (way), a ty
jsou zahrnuty do společné relace Dálnice D1. Nebo například turistická trasa
(od~KČT) může být relace sdružující jak liniové elementy (cesty, pěšiny) tak i bodové
(rozcestníky, vyhlídky, apod. ).
\end{itemize}

U atributů popsaných na OpenStreetMap Wikipedii \cite{OSMfeatures} je vždy uvedeno, k jaké třídě je
vhodné a nevhodné je použít (dle komunity uživatelů OSM). Pokud se stane, že je použit
na~jinou než povolenou třídu, může být následně problém v některých vykreslovačích. 
Viz \ref{Vykreslovače}
%%% ML: viz kapitola?

\subsection{Změna licence}
\label{změna licence}

Původně byla data OSM a generované grafické dlaždice distribuována pod licencí
Creative~Commons~AllributionShare~Alike 2.0 (CC~BY~SA~2.0).

Tato licence umožňovala užití (distribuci ale i editaci) díla pod podmínkou,
že bude uveden zdroj OpenStreetMap.org ve viditelné části
vytvořených mapových dlaždic \cite{OSMlicence}.

  \begin{figure}[hbt]
    \centering
      \includegraphics[scale=0.75]{./pictures/attribution_example.png}
      \caption{Příklad umístění licence,
                zdroj \url{http://www.openstreetmap.org/copyright}}
      \label{fig:attribution_example}
  \end{figure} 

V roce 2012 byla licence publikovaných dat změněna na Open Data Commons
Open Database Licence (ODbL).
Důvodem byla lepší licenční ochrana dat v databázi. \cite{OSMlicenceChange}
Tato změna licence přinesla problém
s~daty, které byly poskytnuty projektu v předchozí licencí
(CC~BY~SA~2.0). Bylo nutné se dotázat každého z dřívějších
přispěvatelů dat, ať už právnických osob, tak i fyzických osob, zdali
souhlasí jejich data budou distribuována pod novou licencí.
U přispěvatelů, kteří to nedovolili, nebo ti co se nevyjádřili,
bylo nutné jejich příspěvky z~databáze OSM vymazat.
Tato situace nastala pouze ve zlomku případů (méně než 1 \%).
Nejvíce tato změna licencí ohrozila data v zemích jako je Polsko a Nový Zéland. \cite {OSMlicenceIssue}

V současnosti jsou tedy data OSM distibuována pod licencí ODbL a
generované grafické dlaždice pod licencí CC-BY SA 4.0. \cite{OSMlicence}

\subsection{Licence ODbL}

%%% ML: preformulovat: Licence ODbl umoznuje...
Licence ODbl umožňuje
\begin{itemize}
    \item    kopírovat, distribuovat a užívat data
    \item    vytvářet nová data z původních
    \item    měnit původní data
\end{itemize}

%%% ML: preformulovat
S použitím ale uživatel musí ale uvést zdroj a licenci dat.
Dále uživatel souhlasí, že nová data vytvořená z původních dat budou sířena
také pod~licencí ODbL.\footnote{Přesné znění viz na \url{http://opendatacommons.org/licenses/odbl/1.0/}}


\subsection{Zdroje dat}
\label{Zdroje dat}
Jak bylo zmíněno, byla snaha, aby mapová data tvořili jedinci prvotním
sběrem dat, tj. měřením vlastními GNSS (GPS, Glonass) přijímači a
znalostí místních poměrů (uzavřené silnice, stezky atd.).  A takto
vzniklé dílo volně užívat k vlastním potřebám.  Komunita přispěvatelů se
zprvu pomalu, později poměrně rychle rozrostla a dnes čítá 3,7 milionů
registrovaných uživatelů s alespoň jednou vytvořenou změnou v OSM a
2,7 milionů účtů aktivních přispěvatelů.\cite{OSMstats}

Takto vzniklé mapové podklady byly velice vhodné i pro další projekt, dnes již
velice rozšířený a známý jako Geocashing (GC). Projekt GC začal mapové
podklady od OSM užívat a zároveň jeho uživatelé začali sami tvořit a
přispívat do OSM. 

Přispěvatelé dat do OSM musí respektovat licenci projektu OdbL.
Tudíž i jejich zdroj dat musí splňovat tuto licenci. Proto by měli
všechny svoje změny, které v OSM vytvoří, řádně ozdrojovat atributem
s~klíčem 
{\tt source}.
V případě vlastního sběru dat se vyplňuje hodnotou
{\tt source=survey} ,
popřípadně uvést zdroj, odkud čerpali. Pokud tuto povinnost poruší a
použijí zdroj, jež není kompatibilní s licenční politikou OSM, tak ostatní 
přispěvatelé do~OSM tuto změnu, aby předešeli sporům, odstraní. 
V tomto případě dojde k odstranění celé sady změn, byť by v~ní byl pouze jeden prvek, jenž to poruší.

Druhým významným zdrojem dat jsou soukromé subjekty (společnosti).
Většinou jde o podkladové zdroje dat, například ortofoto. Pro obkreslování
silničních síti z~leteckých nebo satelitních snímků. V~jejich případě to
bylo řešeno písemným svolením, nebo smlouvou. Jako významným zdrojem byly
mapy Bing, jež nabídla k~dispozici letecké snímky většiny
obydlené pevniny. \footnote{\url{http://wiki.openstreetmap.org/wiki/Bing}}

Třetím zdrojem dat a zároveň postupně dominujícím, co do jeho obsahu, jsou
datové sady ze státního sektoru. Tyto datové sady jsou nejvhodnějším zdrojem
dat.
%%% ML: ze -> produkované
%%% ML: proc ? vyargumentovat

\subsection{Importy}
\label{Importy}
Výraz import v tomto případě znamená začlenění většího množství datových sad
z~jednoho datového úložiště (databáze serveru) na jiný. Při velkých objemech dat
se využívá výkonu výpočetní techniky z důvodu její bezchybovosti, a také
z~důvodu časové náročnosti. Na člověku poté ale zbývá zvolit postup importu
a naprogramovat skript nebo program, podle něhož technika samotný proces
provede. 

Datové importy z veřejných databází do databáze OSM jsou velmi cenné. 
Otevřené geografické, ale i jiné, databáze státu a jeho veřejných institucí 
financovaných státem jsou komplexní. Komplexní v tom smyslu, že obsahují celistvý
soubor dat, protože je daná instituce vyžaduje ke svém chodu. Jistá nevýhoda tu 
ale může být, a to, že data nemusí být vždy úplně aktuální. Některá data mohou 
být sbírána a zveřejněna i s větším časovým odstupem.

V rámci České Republiky proběhlo již několik hromadných datových importů. Jak 
již bylo řečeno, větší časová náročnost zabere samotná příprava na import. A to
v~případě, importu do OSM. Nejen napsání skriptu, ale i nutná diskuze tohoto záměru
na~diskuzní konferenci Talk-cz. 

\subsection{Talk-cz}
\label{Talk-cz}
Tato diskuze probíhá přes posílání emailových zpráv do společné konference. 
Uživatelům chodí emaily z probíhající diskuze a pokud na nějaký chtějí reagovat,
tak pošlou email na adresu serveru, na kterém diskuze běží, a musí do Předmětu 
napsat Re: a předmět zprávy, na kterou reagují. Server tyto zprávy pomocí 
předmětu a času řadí. Diskuze je poté k dispozici na webových stránkách.\footnote{http://lists.openstreetmap.org/listinfo/talk-cz}

\subsection{Vykreslovače}
\label{Vykreslovače}
Na hlavní stránce OSM (\url{http://www.openstreetmap.org}) je k dispozici mapová aplikace. Ta nabízí pět
„základních“ přednastavených vrstev vykreslených z~dat z OSM.
%%% ML: jde o EPSG:3857 - zminit, stejny souradnicovy system pouziva
%%% Google Maps a pod.
Pro snadné vykreslení dat do grafických dlaždic se používá takzvaný pseudo Mercatorovo
zobrazení nebo Web Mercator (EPSG 3857), a to proto, že snadno vykreslí celý povrch Země (až na velké zkreslení u polů). 
První, kdo zobrazení Web Mercartor použil byla spolčnost Google pro svoje mapy Google Maps.\cite{WebMercator}

%%% ML: mozna dodat screenshoty do prilohy?
\begin{itemize}

  \item Standardní vrstva - vykresluje všechny prvky přiměřeně.
  \item Cyklomapa - vykresluje cyklostezky, výškopis. 
  \item Dopravní mapa - vykresluje silniční a železniční sítě.
  \item MapQuest Open - podkladová mapa právě pro potřeby 
    Geocaching.
    %%% ML: restaurace na prvni miste?
  \item Humanitární mapa, která vykresluje služby (restaurace, banky, muzea, 
  školy, kostely...)  a potlačuje ostatní prvky. 

\end{itemize}

%%% ML: kompozici? ruznych dat? dovysvetlit
Existují další stránky, jež se zabývají skládáním a vykreslením
různých dat. Například mapu turistických a cyklistických tras vykresluje
pro celou Evropu mtbmap.\footnote{mtbmap.cz}

%%% priklad? mozna dodat hezky screenshot?
Zajímavými projekty jsou například ty, které k 2D mapě přidávájí „třetí“ rozměr a
vytvářejí tzv. 2.5D mapu. Většinou jde o 3D zobrazení budov, mostů (dle
atributů), popřípadě i stromů.

%%% http://demo.f4map.com/#lat=50.1036063&lon=14.3898880&zoom=19


\section{Opendata}
\label{opendata}

%%% ML: od kud toto cerpate. Otevrena data (ala public domain) maji
%%% svuj puvod mnohem drive, v devadesatych letech...
Základní myšlenka otevřených dat vznikla v USA.
%%% ML: nejen geograficka data
Myšlenka je, pokud vzniknou jakákoliv data z veřejných peněz, měla by tedy být
%%% ML: tady neco tvrdite, ale nemate to podlozeno
přístupná veřejně. Některé studie uvádí, že tento jev měl kladný efekt na ekonomiku.
\footnote{\url{http://www.worldbank.org/content/dam/Worldbank/document/Open-Data-for-Economic-Growth.pdf}}

Proto jako první hlavní zdroj byly satelitní snímky povrchu Země a digitální model terénu
s~rozlišením 30x30 m od NASA (pro pozdější vykreslení vrstevnic).
%%% ML: Landsat a SRTM jsou zverejnena jiz delsi dobu... to opravdu
%%% nesouvisi s vladou BO

Tento trend se začal rozšiřovat zprvu do zemí západní Evropy,
%%% ML: druha cast vety nenavazuje na prvni, jake zeme, opet, nejaka
%%% reference?
jmenovitě Velké Británie, Francie či Německa, ale i jiné země mimo Evropu..

%%% ML: Fond se jmenuje Fond Otakara Motejla (opravdu jej zalozil on,
%%% nebyl zalozen na jeho pocet). Jednim z projektu fondu jsou prave
%%% Otevrena data
V ČR se tomuto věnuje fond Otevřená data\footnote{www.otevrenadata.cz}, který založil Otakar
%%% ML: Sociery? co Rekostrukce statu a pod.?
Motejl. Tento fond spolupracuje s nadací Sociery Fund Praha. V rámci
těchto uskupení je vyvíjen tlak na transparentnost veřejné správy a
zveřejňování smluv a dat
státních institucí, jelikož jejich získání a údržba byla placena
z~veřejných zdrojů.

\section{IPR Praha}
\label{IPR Praha}
IPR Praha je zkratka názvu Institut plánování a rozvoje a hlavního města Prahy. 
Tento institut se věnuje urbanismu, architektury a rozvoje města Prahy. Hlavním
úkolem IPR je tvorba územního plánu Prahy a významným úkolem IPR je zajišťovat
zpracování geografických informací. Spravuje data a mapy města Prahy. Od roku 
2002 poskytuje na svých stránkách zdarma webové aplikace bez limitu využití. 
Po~rozvoji Pražského geoportálu došlo k jejich většímu využívání.  Na základě 
platných Pravidel pro poskytování dat a  výstupů z datových souborů a datového 
skladu Geografického byla od dne 1.~4.~2015 zveřejněny datové soubory a další 
webové služby. Tato data byla uveřejněna pod licencí CC-BY SA 4.0 \cite{IPR}
\subsection{licence CC BY-SA 4.0}
\label{licence CC BY-SA 4.0}
Licence CC BY-SA 4.0 je zde uvedena ve zjednodušeném znění.

"Uživatel s smí
\begin{itemize}
    \item   Sdílet - rozmnožovat a distribuovat materiál prostřednictvím jakéhokoli média v jakémkoli formátu
    \item   Upravovat - remixovat, změnit a vyjít z původního díla
\end{itemize}
pro jakýkoliv účel, a to i komerční.

Poskytovatel licence nemůže odvolat tato oprávnění do té doby, dokud dodržujete licenční podmínky.

Uveďte původ — Je Vaší povinností uvést autorství, poskytnout s dílem odkaz na licenci a vyznačit Vámi provedené změny. Toho můžete docílit jakýmkoli rozumným způsobem, nicméně nikdy ne způsobem naznačujícím, že by poskytovatel licence schvaloval nebo podporoval Vás nebo Váš způsob užití díla.

Zachovejte licenci — Pokud budete toto dílo upravovat, pozměňovat nebo na něj navazovat, musíte svoje odvozená díla vystavovat pod stejnou licencí jako původní dílo."

Podrobněji viz přesné znění na stránkách CraetiveCommmons.
\footnote{https://creativecommons.org/licenses/by-sa/4.0/legalcode/}
